KABUL—Afghanistan signed on to a United Nations-backed plan aimed at ending the recruitment of child soldiers and police, as well as stopping the practice of boys being raped. 

The problems have grown amid an effort by the U.S.-led coalition to increase the size of the Afghan army and police, both of which have added tens of thousands of new service members over the past year.

Among the police, who are often less disciplined than the army, it is common to see young boys in baggy, ill-fighting uniforms, especially in rural areas. They are used for a tradition known as bacha bazi—literally, "boy play" in Dari, one of the national languages—in which they are dressed as young girls, made to dance and then prostituted to the highest bidder in the crowd.

The plan agreed to Sunday involves strengthening laws that ban the practice and sex with minors in general, said Staffan de Mistura, the top U.N. envoy to Afghanistan.

While already illegal, the laws against bacha bazi are relatively weak and the practice is widespread. Even some top officials, provincial governors and powerful pro-government warlords are reputed to partake in the tradition, complicating efforts to combat it.

"When you have a disease you need to identify it and then stake it, otherwise you can pretend it's not there," said Mr. de Mistura. "It's going to be an uphill battle, definitely."

U.N. officials are more hopeful that the growing problem of recruiting underage soldiers and police will be easier to contain. The new plan calls for improving Afghanistan's birth registration system and for making it a crime to falsify ages on national identity documents, the U.N. said in a statement.

Officials say the problem isn't yet widespread, thus the need to take preventative steps before it becomes so. Many Afghans are unaware of their exact age, and military commanders have been caught falsifying national identification documents to allow teenage recruits to serve in the nation's security forces, Mr. de Mistura told reporters.

Afghan Foreign Minister Zalmai Rassoul signed the agreement Sunday in Kabul with the U.N.'s special representative for children and armed conflict, Radhika Coomaraswamy.

While not party to the agreement, the Taliban also frequently violate children's rights, using young boys to plant bombs and even fight, Ms. Coomaraswamy said.

—Habib Khan Totakhil  contributed to this article.