Amid all the debate about bankruptcy and bailouts and all the headlines about local-government layoffs, benefit cuts, reduced services and tax increases, ponder one simple question: 

How the heck did state and local governments get in such trouble?

It's no small matter. State and local governments are a big and growing part of the U.S. economy. They account for 15% of all economic output, up from less than 12% two decades ago. They employ one in every seven workers, more than manufacturing. 

Here are four of the big causes of today's fiscal woes: 

 It was the recession.  

The deep and long recession devastated tax revenue. At the worst point, in early 2009, state and local tax revenue combined were down 11% from year-earlier levels. Local governments took a hit from the housing bust. State governments got hammered when the income, spending and capital gains they tax declined. Despite an improving U.S. economy, tax receipts at the state level remain 12% below pre-recession peaks. 

The federal fiscal stimulus offset some of that drop in tax revenue, warding off bigger spending cuts and tax increases that would have exacerbated the recession. But no one was prepared for a downturn like the one we had. Rainy-day funds were depleted. State unemployment-compensation funds borrowed from Washington interest-free, only to find the grace period expiring before the jobless were working again. At the same time, the recession boosted demand for state services such as community colleges and the state-federal Medicaid health-insurance program for the poor.

See state and local budgets as a percent of U.S. GDP, 1961-2008.

 It was the boom. 

In the good times, governments enjoyed and spent a tax windfall; state and local tax revenue rose 36% in the five years before the bust. In the mid-2000s, overall receipts—taxes and federal grants—rose rapidly. In the ensuing years, spending rose rapidly too. Flush with money, government did more, often encouraged by voters who wanted more spending on education, for instance.

Going into the recession, spending exceeded the revenue that states and localities can expect to collect in normal times. The gaping budget holes vexing city councils and state legislatures are largely the result of the recession; projected future deficits aren't. And those won't go away without scaling back government (beyond the half a million state and local government jobs cut already) or raising taxes (beyond the $40 billion in tax and fee increases that the National Association of State Budget Officers estimates state governments alone have legislated in the past two years).

 It's health care. 

When the economy heals, state and local revenue will grow again. But that won't relieve unsustainable pressures that predate the recession, especially health costs. 

In 1978, health spending—from Medicaid to employee benefits—accounted for 12% of state and local spending. Twenty years later it was 20% of much-larger budgets. "The primary driver of fiscal challenges for state and local government continues to be growth in health costs," the congressional Government Accountability Office says. Medicaid accounts for more than $1 in every $5 of state spending, more than states spend on elementary and secondary education.

State governments are covering more people and the cost of caring for them is rising faster than nearly anything else. Soon the extra federal aid provided during the recession will run out. Missouri, for instance, estimates it would need a 3% increase in revenue to cover the projected $200 million increase in Medicaid costs next year, according to the National Conference of State Legislatures. The Obama health-care law expands the number of Americans insured by Medicaid, which already covers 55 million people. 

 It's the pensions. 

By any metric, and there's a debate over which is the right one, state and local governments haven't set aside enough money to cover pension or retiree health-benefit promises they've made to their workers. Governments and public-employee unions agreed to pension and health benefits—and stuck future taxpayers with the tab.

States and localities got religion in the mid-1970s and began funding their pensions more soundly, but then a long bull market led management and unions to count on super-charged stock-market returns to cover the future costs. Stock-market busts of the early and late 2000s show the downsides of that strategy. 

Now governments need to put a lot of money into the pension funds or dilute the promises or, at least for new hires, move away from old-style pensions to the 401(k)-style plans common in the private sector, or all three.

A few big states are in decent shape, such as Massachusetts and Florida. But the problem is acute in a few very big states—California, Illinois and New Jersey—that offered very generous pensions or didn't make the annual contributions that even the most lenient accounting rules required, or both. 

State and local governments have been putting about 3.8% of their budgets into pensions. If they continue to count on 8% investment returns, which doesn't seem prudent, they will need to put in 5% by 2014. Using a more reasonable rate of return of 5%, Boston College's Center for Retirement Research estimates, states will have to put 9.1% of their budgets into pensions, on average. For California, Illinois and New Jersey, it's 12%. 

In state legislatures and city councils, just as in the Congress in Washington, tinkering won't suffice.

 Write to  David Wessel at capital@wsj.com 