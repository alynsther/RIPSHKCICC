U.S. authorities in Texas arrested three members of an alleged weapons trafficking ring and accused one of them of buying a pistol used in a February attack that killed a U.S. government agent in Mexico. 

The three men are brothers  Ranferi Osorio and  Otilio Osorio, 27 and 22 years old, and  Kelvin Leon Morrison, 25. All were charged in criminal complaints filed in U.S. District Court in Dallas. 

The men were the subject of an undercover investigation by agents from the Bureau of Alcohol, Tobacco, Firearms and Explosives and the Drug Enforcement Administration in November. Investigators were attempting to track weapons bought in the U.S. that were allegedly then smuggled into Mexico, according to an ATF affidavit filed in court. The affidavit alleges that the purchases were made on behalf of the drug gang known as Los Zetas, one of several groups fighting a bloody war for control of territory in Mexico. 

Separate from the undercover probe, U.S. authorities said, ballistics tests linked the weapons ring to one of three guns recovered from the Feb. 15 attack, in which  Jaime Zapata, a special agent with Immigration and Customs Enforcement, was killed. Mr. Zapata was traveling in Mexico with  Victor Avila, another ICE agent attached to the U.S. Embassy, who was injured in the assault. 

A Romarm-Cugir Draco 7.62 pistol recovered in the attack was traced to Otilio Osorio, who purchased it from a dealer in Joshua, Texas, the ATF said. The purchase occurred Oct. 10, nearly a month before the November undercover investigation, the affidavit says. Federal investigators running the undercover case weren't aware of the earlier purchase. 

In the undercover probe, the ATF affidavit alleges, the Osorio brothers delivered weapons to an ATF informant under a sting set up by DEA agents who were investigating U.S. weapons purchases by Los Zetas. The ATF later orchestrated the seizure of the 40 weapons included in shipments delivered by the men, ranging from pistols to rifles and shotguns, all with serial numbers that were obliterated, the ATF affidavit says.

Mr. Morrison's role in the alleged Osorio ring was to make "straw purchases" of weapons, according to U.S. authorities. In an interview with ATF investigators, Mr. Morrison, a next-door neighbor of the Osorios, said that to make "a little extra money" he purchased at least 20 firearms, which he provided to unknown men in parking lots outside gun shows, U.S. authorities said. The affidavit says Mr. Morrison "refused to admit the identity of the person for whom he was purchasing these firearms." Mr. Morrison faces additional charges of making false statements.

 Write to  Evan Perez at evan.perez@wsj.com 