Yemen's president and the country's top general are hashing out a settlement in which both men would resign within days, people familiar with the situation said, raising crucial questions of who will end up leading a key, though embattled, U.S. counterterrorism ally.

The outlines of a peaceful transition, to a civilian-led transitional government, emerged amid rising tension over the standoff between Yemeni President Ali Abdullah Saleh and pro-democracy protesters backed by Gen. Ali Mohsen al-Ahmar. The general this week broke ranks and declared his support for protesters demanding that the president resign immediately.

Opposing tanks from units loyal to Mr. Saleh and to Gen. Ahmar have faced off in the streets of San'a all week and tens of thousands of antigovernment demonstrators vowed to continue their protest Friday in the capital's Change Square. 

The U.S. and governments in the region have worried that the weeks-long political crisis in the fractious Arab nation would disrupt counterterrorism operations and allow the al Qaeda affiliate in Yemen to expand.

Mr. Saleh and Gen. Ahmar were intent on preventing bloodshed and preserving stability, the people familiar with the negotiations said. Aides to both men said they understood that Mr. Saleh's continued rule is untenable. But the two men also agreed that his resignation can't happen until the details of a transitional governing council that would take his place have been worked out. 

"Both sides have agreed on the main points of departure, and Saturday is expected to be the day that Saleh and Gen. Ahmar both step down," a senior official familiar with the negotiations said.

It couldn't be determined who would lead the transitional council—or who would run counterterrorism operations should Mr. Saleh resign. Most of America's top counterterrorism partners in Yemen are Mr. Saleh's relatives, including his eldest sonand two nephews who head elite units funded and trained by the U.S. The fate of those officials or their security forces in a post-Saleh Yemen was unclear.

Yemen has been a top national security concern for Washington for years, but jumped higher still after 2009 when al Qaeda said it had organized a new affiliate based in Yemen and failed in two bomb attacks against airliners. Yemen also is home to radical cleric Anwar al-Awlaqi, who U.S. officials believe had a role in inspiring the Foot Hood, Texas, shootings.

Track events day by day.

The prospects for the U.S. would be dicey even with an orderly transition of power. With Mr. Saleh's departure, so goes a 10-year counterterrorism relationship.

"If we see leadership changes, we'd be starting from scratch to build relationships. And personal relationships are the key to counter terrorism," said Katherine Zimmerman, a Yemen specialist at the American Enterprise Institute's Critical Threats Project. Yet if a leader with domestic legitimacy emerged who was willing to work with the U.S., "that could be a game changer" because Mr. Saleh's cooperation has been mixed at best over the years, she said.

The U.S. has kept comments on Yemen close to the vest. "We do not build our policy in any country around a single person, and we obviously will look forward to having a solid relationship to the leader of Yemen," White House spokesman Jay Carney told reporters. 

On Thursday evening, political negotiations widened from talks between Mr. Saleh and Gen. Ahmar to include meetings between their aides, Yemeni Vice President Abdo Rabu Hadi, U.S. Ambassador to Yemen Gerald Feierstein and the leaders of two opposition parties, the Socialist Party and the Islah Party. The U.S. Embassy didn't respond to requests for comment, and the other participants couldn't be reached.

Though pipelines that ship roughly 55,000 to 75,000 barrels of oil day have been closed following rebel or tribal attacks, oil continued to flow from Yemen. The country accounts for 260,000 barrels a day, well under 1% of world output.

Mr. Saleh has ruled Yemen throughout its modern history, so nationally respected leaders are hard to find. The support for mainstream opposition party leaders is unclear across the rugged and largely conservative country. Meanwhile, tribal leaders who have great social standing would face problems exerting authority over rival tribes.

Mr. Saleh and Gen. Ahmar, who hail from the same tribe, have controlled Yemen for the last 32 years, steering it out of a civil war, the threat of domestic armed insurgents and al Qaeda networks. More recently, the men's relations turned frosty, according to diplomats. Mr. Saleh, 66 years old, sees the general as a rival for power, and the president has sought to sideline the commander while advancing Mr. Saleh's eldest son as a possible successor, according to diplomats.

Earlier this week opposition forces deputized Gen. Ahmar to press their demands with the president, who had flatly refused to step down before next year.

Talks took a significant step forward early Thursday.

The apparent breakthrough came after a marathon round of acrimonious telephone discussions, via aides, that started around 9 p.m. Wednesday between the president at his official residence and the general, who was at his home in downtown San'a, the people said.

They said President Saleh and Gen. Ahmar agreed to the central demand of the protest movement: that a civilian council should rule in place of Mr. Saleh, instead of an Egyptian-style military council.

By the start of the dawn prayer Thursday morning, the men hadn't worked out the structure or the composition of such an authority.

After a brief rest, discussions continued Thursday, after the two sides briefed the U.S. and British ambassadors to Yemen about their progress, according to the people familiar with the negotiations.

—Keith Johnson in Washington contributed to this article.

 Write to  Margaret Coker at margaret.coker@wsj.com 