They have been talking about divorce on and off since late summer. But only during the past few weeks did cable-news network MSNBC and host  Keith Olbermann finally feel ready to call it quits. 

Friday's announcement that Mr. Olbermann would leave capped months of internal tension, during which Mr. Olbermann's representatives sought at least twice to be bought out of his contract, and MSNBC laid the groundwork to replace the man who had juiced its audience but rankled its executives, according to people familiar with the matter.

The latest round of buyout talks began in recent weeks, spurred by Mr. Olbermann's agents from International Creative Management, some of those people said. But tensions had grown since summer, when Mr. Olbermann and his representatives had spats with the network, including over his removal from football broadcasts on sister channel NBC, people familiar with the matter said. 

Mr. Olbermann's clashes with the network have intensified since November, when MSNBC briefly suspended Mr. Olbermann for making political donations without permission.

It was during that dispute that MSNBC executives thought Mr. Olbermann remained defiant, according to people familiar with their thinking. Representatives for Mr. Olbermann declined to comment and make him available for comment. 

The deal that Mr. Olbermann and MSNBC hammered out late last week will pay the host roughly $7 million, or one year's salary, two people familiar with the matter said. It also includes provisions that could in some cases keep Mr. Olbermann from taking another television job for roughly a year, bar him from appearances and interviews for a period of several months, and restrict disparagement from either side, those people added.

Mr. Olbermann had been under a four-year $30 million contract scheduled to expire at the end of 2012.

On Friday evening, MSNBC asked its on-air talent and staff at MSNBC and NBC News to refrain from mentioning Mr. Olbermann publicly for a period of time, according to two people familiar with the matter.

MSNBC has been planning for this day. Last fall, executives gave  Lawrence O'Donnell—who had filled in for Mr. Olbermann—a regular program at 10 p.m. specifically to groom him for Mr. Olbermann's slot at 8 p.m., assuming he would eventually leave, a person familiar with the matter said. On Friday, MSNBC said Mr. O'Donnell would slide into the timeslot beginning Monday.

  Phil Griffin, MSNBC's president, said on Saturday that he saw the new lineup—featuring a string of liberal shows hosted by  Rachel Maddow, Ed Schultz, and Mr. O'Donnell but no Mr. Olbermann—as a permanent network fixture.

"I'm committed to this for years," he said. "It fits with who we are as a network."

Mr. Griffin said Mr. Olbermann's exit won't jeopardize MSNBC, which has broadened its appeal in recent years. At 9 p.m., Ms. Maddow's show averaged 954,000 viewers in the fourth quarter of 2010, just below Mr. Olbermann's average of one million, according to  Nielsen Co. numbers provided by MSNBC.

"Going forward, we are in a great position with a lineup of proven hosts and I feel very comfortable where we are," added Mr. Griffin, emphasizing that the new roster fits in well with the personality of his network. 

Swapping in Mr. O'Donnell could be a financial windfall for MSNBC. Mr. O'Donnell's contract costs a fraction of Mr. Olbermann's, according to two people familiar with the matter. MSNBC said that he has in the past been able to hold onto much of Mr. Olbermann's audience when acting as a fill-in.

Still, such a change presents a risk.

"Cable's all about larger than life, dominating, provocative personalities, and Olbermann is the perfect cable star," said  Victor Neufeld, a consultant and former executive producer at CNN, ABC News and CBS News. "The fact that MSNBC and him couldn't resolve any problems is a real loss for both of them."

The abrupt change could present an opening for  Time Warner Inc.'s CNN, which has had trouble finding traction for "Parker Spitzer" in the competitive 8 p.m. hour. But CNN and MSNBC both still face the challenge of facing off against  Bill O'Reilly, who brings in the biggest cable-news audience in the hour for Fox News. ( News Corp. owns both Fox News and The Wall Street Journal.)

The change at MSNBC came only days after  Comcast Corp. had received Washington approval to take over network parent NBC Universal from  General Electric Co. That transaction is expected to close on Friday.

Though Comcast executives didn't make the decision to end Mr. Olbermann's contract, they were kept informed and didn't object, according to people familiar with the matter. 