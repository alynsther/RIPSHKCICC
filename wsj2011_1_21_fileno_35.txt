ISLAMABAD, Pakistan—A massive U.S. aid program that has made Pakistan the world's second-largest recipient of American economic and development assistance is facing serious challenges, people involved in the effort say.

The ambitious civilian-aid program is intended in part to bolster support for the U.S. in the volatile and strategically vital nation. But a host of problems on the ground are hampering the initiative.

• A push to give more money directly to local organizations and the Pakistani government has been slowed by concerns about the capacity of local groups to properly handle the funds.

• Some international groups have balked at new requirements, such as prominently displaying U.S. government logos on food shipments, and have pulled out of U.S. government programs.

• Anti-American sentiment in the nation continues to flourish despite the uptick in spending, in part because of American drone attacks on tribal regions. A poll of Pakistanis in July by the Washington-based Pew Research Center showed that two-thirds of respondents considered the U.S. an enemy. 

"Drone strikes cannot be justified because civilians are also killed in them, which further aggravates a tense situation," said Bacha Khan, a refugee from Bajaur, a tribal region along the Afghan border where the Pakistani army is fighting Taliban militants.

Due to various problems, in the year ended Sept. 30, the U.S. spent only about two-thirds of the roughly $1.2 billion appropriated by Congress.

U.S. officials acknowledge difficulties distributing so much money, but say the shift in direction is needed. "Our goal here is to help the [Pakistani] government improve its capacity to deliver key public services," says senior State Department official Robin Raphel, U.S. Coordinator for Economic and Development Assistance in Pakistan. "The object of the program is quality, not to push money out of the door."

The U.S. is eager to win support from ordinary Pakistanis to boost its prospects in the war in neighboring Afghanistan and to counter the rise of Islamic extremism in Pakistan itself, a trend that officials say directly threatens America. 

In 2009, Congress agreed to spend even more in Pakistan: $1.5 billion annually for civilian aid, over five years. The first tranche of that money is being spent in the current fiscal year.

The ramped-up aid program took shape at a time of instability for the U.S. Agency for International Development, the aid arm of the U.S. government. It lacked an administrator for about a year after Barack Obama took office. Veteran diplomat Richard Holbrooke, named a special envoy to Afghanistan and Pakistan by Mr. Obama, died in December after ordering major changes to the way aid is distributed in Pakistan. U.S. officials say his policy changes will continue.

When Mr. Holbrooke took the job in early 2009, he was frustrated that all of the money the U.S. was pouring into Pakistan hadn't improved America's image. In March 2009, he called a meeting in India of all aid officials involved in Afghanistan, Pakistan and the Central Asian republics to outline how things would change. 

"He thought everything we were doing was a failure," recalls one participant in the meeting.

Mr. Holbrooke decided to shift focus—to give more aid directly to local organizations and the Pakistani government, and less to foreign nongovernmental organizations that handled the bulk in the past. He also decided to publicize projects more aggressively to show ordinary Pakistanis that they are benefitting from U.S. funds.

He started curtailing existing programs handled by foreign contractors that he viewed as wasting money. Many of them involved less visible and harder-to-measure programs such as initiatives to improve the justice system or local bureaucracies. He directed the aid instead to visible infrastructure projects like roads, bridges and dams, especially in the volatile tribal regions that border Afghanistan.

In all, USAID-funded projects involving foreign organizations worth almost $200 million have been scrapped due to the new strategy. Other projects were denied new money. In June 2009, for example, Mr. Holbrooke refused requests for an increase in funding from Maryland-based Development Alternatives Inc., a contractor that was running a $46 million, three-year project to help train government workers in the tribal region. U.S. officials say it is difficult for foreigners to monitor projects in the tribal areas because of the security risk of going there. 

U.S. officials contend that the previous reliance on foreign contractors bred ill will among Pakistanis, who saw them spending lavishly on houses and cars. The new approach, they say, involves the Pakistani government more in how the money is spent, a move intended to improve often testy relations between Washington and Islamabad.

Some nongovernmental organizations have objected to the new direction. Last month, Care International, an American charity, pulled out of a U.S.-funded project to train Pakistani workers, citing "safety concerns," after the U.S. asked it to focus on the dangerous border region with Afghanistan. Oxfam International, also late last year, declined U.S. funding for its Pakistan flood-relief program after Washington demanded that it prominently display U.S. government logos on its food. Some aid organizations worry that such logos could provoke attacks by militants.

The Pakistani government is slated to receive at least half of all funding under the new plan, up from about 10% before. Corruption problems raise the prospect that significant amounts will be diverted. Sen. John Kerry, a key architect of the civilian-aid package, warned in a letter to Mr. Holbrooke last year that so much money going through untested Pakistani institutions could fuel corruption and hurt the U.S.'s image. 

Mr. Holbrooke responded that the U.S. was working to prevent that from happening. The U.S., for example, signed an agreement in September with Transparency International, a Berlin-based corruption watchdog, to set up a hot line in Pakistan to report evidence of corruption. That plan already has run into problems. In November, the chairwoman of Transparency International, Huguette Labelle, wrote to Pakistan President Asif Ali Zardari to complain about death threats and "possible state intimidation" against Transparency's local head in the wake of its USAID pact.

It is unclear whether Pakistan's nongovernmental organizations are prepared to handle a massive influx of funds. "I think $1.5 billion is too much money for this country," says Shandana Khan, head of a nationwide network of rural-development organizations that recently won a $20 million grant from USAID. "This country doesn't have many organizations that can absorb this kind of money."

Some senior USAID staffers have complained that the change in policy has happened too quickly for the agency to find suitable new programs. "Large amounts of new funds are coming online, and it will take considerable time and effort to design new activities that will make wise use of that money," Stuart Callison, a senior USAID development economist, said in an email to agency officials in October 2009. A USAID spokesman declined to comment on the email, and Mr. Callison didn't respond to requests for comment.

In the year ended Sept. 30, USAID spent only $770 million of the roughly $1.2 billion appropriated by Congress for the period. With a backlog of assistance to disburse, the U.S. now must try to find ways to almost double spending by Sept. 30. That amounts to roughly $10 for each Pakistani. 

Many Pakistanis see the U.S. history of economic assistance as inconsistent, and resent that U.S. aid often has propped up military dictatorships. 

After World War II, the U.S. embraced Pakistan as an ally in the Cold War. During the first half of the 1960s, the U.S. accounted for more than half of all foreign aid to Pakistan.

Aid was cut off in the late 1970s to punish Pakistan for seeking to develop nuclear weapons. But billions of assistance dollars flowed in during the 1980s to reward Pakistan for organizing the jihad against Soviet troops in Afghanistan. 

Aid was cut again in 1990 after the Soviets withdrew from Afghanistan. USAID shut its Pakistan office in the mid-1990s, only to reopen it in 2002 after the country became an ally in fighting the Taliban.

Since 2003, civilian aid has risen steadily. The U.S. also has been a major supplier of military aid, giving $11 billion since 2001.

But the torrent of dollars doesn't seem to have done much to improve the U.S. image. USAID contractors are regularly portrayed in the Pakistani press as being from Blackwater Worldwide, the security firm now called Xe Services LLC, whose actions while guarding U.S. government installations and personnel in Iraq have been highly controversial.

"The popular perception that the public has seen little benefit from the billions of U.S. funding has encouraged a number of conspiracy theories about the ultimate and malignant objectives of the U.S. government as exercised through its assistance programs," Christine Fair, a Pakistan expert at Georgetown University, told Congress in 2009.

Andrew Wilder, a former head of Save The Children in Pakistan and director of Afghanistan and Pakistan programs at the U.S. Institute of Peace, a Washington think tank, adds: "The idea that by giving them money we can buy their hearts and minds is a rather simplistic analysis of what's driving anti-American sentiment in Pakistan." 

Public sentiment has been hurt by the Central Intelligence Agency's ongoing campaign to use missiles fired from pilotless drones to kill al Qaeda and Taliban fighters in Pakistan's tribal regions. Civilians also have been killed in such attacks.

U.S. officials do not acknowledge the drone strikes and won't comment on how they might affect public opinion. "It is in both countries' and the region's interest to have security and stability on both sides of the Afghan/Pak border—an elusive but attainable goal," said Alberto Rodriguez, a U.S. embassy spokesman in Islamabad, in an email.

Mr. Khan, the Bajaur refugee who is critical of the drone attacks, recently received USAID-branded food from a United Nation's distribution post in Charsadda, a town northeast of Peshawar. Even though the Taliban has been targeting food-distribution centers, he laid blame for the escalating violence on the U.S. On Christmas Day, the Taliban claimed responsibility for an attack by a female suicide bomber who killed 46 in Bajaur.

Shaukat Khan, another refugee who has received food from USAID, faults the U.S. for his predicament. "In Bajaur, we had a lot of land planted with crops, but these were destroyed by America," he said recently, speaking in a squalid room near Charsadda, where he is living with his wife and five children, the youngest only days old. "It's because of America being in Afghanistan that Bajaur is not at peace." 

A road project in South Waziristan, a tribal region that has been a base for Taliban militants and a focus of the CIA's drone campaign, shows how difficult it is to use aid to change public sentiment. 

A year ago, the U.S. signed an agreement to pump $55 million through a local government body into roads, water and electricity in South Waziristan, where anti-Americanism is rampant. Six months ago, to improve access to markets, schools and health facilities, workers began transforming a winding, potholed mountain road between the towns of Tank and Makin into a wide, paved road. Because of militant attacks, the Pakistani army's public-works division is leading construction.

Habibullah Khan, a senior government official in the region, said the move to fund bigger infrastructure projects in South Waziristan has gained local support. But he said it's too dangerous for now to put any USAID logos on the road because of possible reprisals against workers. He said the government plans to do so once the road is finished. 

Haji Mursalin, a tribal elder from the region, says locals support the road but don't like America any more as a result. "The construction of roads won't work because our whole social structure has been destroyed," Mr. Mursalin said. "Most of the common people are against drone strikes because most of the time there are civilian casualties and collateral damage."

Last summer's devastating floods in Pakistan, which killed almost 2,000 and affected 20 million others, gave the U.S. a chance to showcase its assistance. When Mr. Holbrooke visited the flood zone in September, he stressed that the U.S. was the biggest donor to flood relief. USAID paid for emergency food, shelter and seeds for the winter's wheat-planting season.

Haq Nawaz, a 38-year-old farmer from Nowshera Kalan, a village near Peshawar, lost his house and crops. He received seeds for wheat, peas and radishes from a local organization helping farmers on behalf of USAID. But his view of the U.S. hasn't changed.

"I like America's money, but I don't like their bullets," he said. "It is fair enough that they are fighting the Taliban, but they kill too many innocent civilians."

—Rehmat Mehsud contributed to this article. 

 Write to  Tom Wright at tom.wright@wsj.com 