The U.S. accused a former director of Goldman Sachs Group Inc. and  Procter & Gamble Co. of passing inside information about the two companies to a hedge-fund titan at a critical moment in American financial history.

In a civil administrative proceeding, the Securities and Exchange Commission alleged that the director,  Rajat Gupta, tipped Galleon Group founder  Raj Rajaratnam about quarterly earnings results for both Goldman and P&G during the financial crisis of 2008.

In the most incendiary allegation of the case, the SEC said Mr. Gupta, serving as a Goldman board member, told Mr. Rajaratnam about a $5 billion investment in Goldman by Warren Buffett's Berkshire Hathaway Inc. before a public announcement of the deal at the depth of the financial panic.

Mr. Gupta called Mr. Rajaratnam after the Goldman board approved the Berkshire deal, "just minutes" before the market closed on Sept. 23, 2008—allowing Galleon to buy Goldman shares and generate a profit of $900,000, the SEC alleged. 

The Berkshire investment was a major turning point in the financial panic: One of the world's savviest investors, Mr. Buffett helped ease fears about the instability of the financial system by backing America's leading securities firm.

A lawyer for Mr. Gupta, 62 years old, said his client had "done nothing wrong." "There is no allegation that Mr. Gupta traded in any of these securities or shared in any profits as part of any quid pro quo," Gary Naftalis, the lawyer, said in a statement.

The alleged tip by Mr. Gupta about Goldman—first reported by The Wall Street Journal in April 2010—has drawn intense interest because it involves a trusted figure in the business and financial community: a then-serving director who regulators say was an insider-trading pipeline to Mr. Rajaratnam.

The alleged inside information about Goldman and P&G led to a total of $18 million in illicit profits and avoided losses for Mr. Rajaratnam and others, the SEC alleged.

Mr. Gupta resigned as a Goldman director in May 2010. He resigned his position as a P&G board member Tuesday. 

A P&G spokesman said Mr. Gupta "voluntarily resigned" and that he "is stepping down in the interest of the company and to prevent any distraction to the P&G board and our business." 

Mr. Gupta, a friend and business associate of Mr. Rajaratnam, "was honored with the highest trust of leading public companies, and he betrayed that trust by disclosing their most sensitive and valuable secrets," said Robert Khuzami, the SEC's enforcement chief. 

Goldman declined to comment. Neither Goldman nor P&G was accused of wrongdoing.

Mr. Rajaratnam's lawyer, John Dowd, said there is "no merit" to the SEC charges. "This is simply an effort to destroy a favorable witness. There is no case, absolutely none. No conversations, no benefit, no nothing. These are old friends and Mr. Gupta is a distinguished human being." 

The civil SEC action Tuesday against Mr. Gupta is linked to a larger criminal case in which 19 of 26 defendants have pleaded guilty to participating in an insider-trading scheme involving Galleon. 

Mr. Rajaratnam, 53, who is at the center of that case, is fighting the charges. His trial is slated to begin next week in a Manhattan federal court in Foley Square, the site of numerous white-collar cases over many decades. Mr. Gupta hasn't been charged in the criminal case. If civil charges are proven by the SEC, Mr. Gupta could be forced to pay a fine. 

A spokeswoman for the Manhattan U.S. Attorney's office declined to comment.

The SEC doesn't say specifically what Mr. Gupta said in the alleged call with Mr. Rajaratnam after the Goldman board meeting.

The SEC said Mr. Gupta called Mr. Rajaratnam after the Goldman board approved the investment by Mr. Buffett and that Mr. Rajaratnam bought 175,000 shares before the market closed and the deal was announced on Sept. 23. The next day, Galleon sold the shares for a $900,000 profit, the SEC says.

Separately, the SEC also alleged that Mr. Gupta informed Mr. Rajaratnam of Goldman's financial results for both the second and fourth quarters of 2008 before they were announced.

Mr. Rajaratnam, for instance, told an unnamed "participant" in the alleged insider-trading scheme in October 2008 that he had heard from a Goldman director that the big securities firm would record a loss of $2 a share in the 2008 fourth quarter, according to the SEC. 

That was far worse than the $2.50 per-share profit that analysts had been expecting. 

 Greed will always bring about one's downfall -- it's like cancer, it may not kill you today but it will finally catch up to you and overtake you. 

—Phillip Hwee

Galleon sold Goldman shares based on that information, avoiding a loss of more than $3 million, the SEC alleges.

On June 10, 2008, a week before Goldman's second-quarter results were announced, Goldman Chief Executive Officer Lloyd Blankfein called Mr. Gupta to apprise him of the firm's financial status, the SEC says in its administrative proceeding.

Mr. Blankfein declined to comment. 

That night, the SEC alleges, Mr. Gupta called Mr. Rajaratnam's home. "The call was the first in a flurry of short calls between the two over an 18-minute span that night," the SEC says. Over the next two days, Galleon bought Goldman shares and options, the SEC said.

After the second-quarter results were announced, Galleon profited by selling these positions, according to the SEC.

Mr. Rajaratnam's trial is set to begin March 8. The allegations involving tips about Goldman could be discussed during the trial, according to lawyers. It's unclear whom the government may call to testify in regard to those allegations.

Mr. Gupta had been head of McKinsey & Co., the large consulting firm, from 1994 to 2003. McKinsey hasn't been accused of wrongdoing. On Tuesday, a McKinsey spokesman said: "We were saddened to learn about the civil charges against our former colleague." 

—Chad Bray and Liz Rappaport contributed to this article.

 Write to  Susan Pulliam at susan.pulliam@wsj.com 