  Google Inc. is close to settling a U.S. criminal investigation into allegations it made hundreds of millions of dollars by accepting ads from online pharmacies that break U.S. laws, according to people familiar with the matter. 

The Internet company disclosed in a cryptic regulatory filing earlier this week that it was setting aside $500 million to potentially resolve a case with the Justice Department. A payment of that size would be among the highest penalties paid by companies in disputes with the U.S. government. 

Google gave few details in its filing about the probe, saying only that it involved "the use of Google advertising by certain advertisers."

The federal investigation has examined whether Google knowingly accepted ads from online pharmacies, based in Canada and elsewhere, that violated U.S. laws, according to the people familiar with the matter. 

A Google spokesman declined to comment, as did a Justice Department spokeswoman. 

Search engines can be liable if they are found to be profiting from illegal activity. In December 2007, the three largest Internet companies, Google,  Microsoft Corp.
MSFT


0.31
%




 and  Yahoo Inc.
YHOO


-0.65
%




 agreed to pay a combined $31.5 million fine to settle civil allegations brought by the Justice Department that they had accepted ads from illegal gambling sites. 

Prosecutors can charge such acts under a number of different statutes. From a legal standpoint, a key distinction for Google would be that the illegal activity allegedly took place through its paid advertising service, not just the results that its search engine produces. 

There are scores of websites that offer to sell prescription drugs. Some violate U.S. laws by selling counterfeit or expired medicines or dispensing without a valid doctor's prescription.

One question under investigation is the extent to which Google knowingly turned a blind eye to the alleged illicit activities of some of its advertisers—and how much executives knew, the people familiar with the matter said.

The probe has been conducted by the U.S. Attorney's Office in Rhode Island and the Food and Drug Administration, among other agencies, according to these people. A spokesman for Rhode Island U.S. Attorney  Peter Neronha declined to comment. A spokeswoman for the FDA said the investigation was ongoing and declined to comment further.

Google generated nearly $30 billion in total ad revenue in 2010, largely from its AdWords system. AdWords helped revolutionize online advertising, offering marketers the chance to bid to display their ads when people searched for certain keywords on the Google search engine. An advertiser only pays when a user clicks on the ad.

Google, like other Internet companies, has struggled for years to deal with what it calls "rogue online pharmacies." In 2003, for instance, Google said it banned ads from U.S. companies that offer drugs like Vicodin and Viagra without a prescription.

Google acted after rivals, including Yahoo and Microsoft, made similar moves as the FDA began publicly pressuring sites to accept only drug ads from licensed Internet pharmacies. 

But Google said in 2004 it would continue carrying ads for Canadian pharmacies that send medicines to U.S. customers. The decision riled some U.S. druggists and drew criticism from regulators. 

After the FDA began its latest investigation, Google made changes last year to its policies for drug ads, according to a person familiar with the matter. 

Google said in February 2010 it would begin allowing ads only from U.S. pharmacies accredited by the National Association of Boards of Pharmacy and from online pharmacies in Canada that are accredited by the Canadian International Pharmacy Association.

In September Google filed a federal lawsuit in San Jose, Calif., seeking to block individuals running illegitimate pharmacies from advertising on its search engine and to recover damages. 

"Rogue pharmacies are bad for our users, for legitimate online pharmacies and for the entire e-commerce industry—so we are going to keep investing time and money to stop these kinds of harmful practices," Google lawyer  Michael Zwibelman wrote on the company blog at the time.

  Sergey Brin, Google's co-founder and a current high-ranking executive and board member, sidestepped questions about the investigation at a conference Wednesday and alluded to the fact that Larry Page is now running the company.

"Luckily, since we changed roles a few months ago, I don't have to deal with filings, and the DOJ, the SEC or other acronyms," Mr. Brin said, using the initials for the Justice Department and Securities and Exchange Commission.

The current investigation is Google's latest brush with law enforcement and regulatory agencies in both the U.S. and abroad. The company is facing multiple investigations into possible antitrust and privacy violations in several nations. Google maintains that its breakneck growth will inevitably attract greater regulatory scrutiny, and that it's done nothing wrong in connection with other probes. 

There are other signs the government is serious about cracking down on illegal online pharmacies. On Thursday, entering the words "no prescription required" into Google's search engine produced an ad that led to a Justice Department alert reading: "Prescription Drugs. Buying online could mean doing time."

—Don Clark  and Siobhan Gorman contributed to this article.

 Write to  Thomas Catan at thomas.catan@wsj.com and Amir Efrati at amir.efrati@wsj.com 